\documentclass{article}

\usepackage{amsmath}
\usepackage{geometry}

\newcommand{\norm}[1]{\left\lVert\,#1\,\right\rVert}

\title{{\Huge \textbf{Assignment 1}}\\
Deriving the implicit formula for the cylinder}
\author{Ding Markus \and Mamie Robin \and Montial Charline}

\begin{document}
    \maketitle
    
    To get the implicit equation, the following one needs to be solved:
    
    \[ \norm{x - c'} - r = 0 \]
    
    where $x$ is the intersection of the ray and the cylinder, $c'$ is the projection of this point onto the axis of the cylinder and $r$ its radius.
    
    To compute $c'$, let us define $\vec{a}$ as its normalized axis, $c$ as its center and $\vec{b}$ as the vector pointing from $c$ to $x$ -- i.e. $\vec{b} = x - c$.
    By computing the dot product between $\vec{b} \cdot \vec{a}$, we get the distance between $c$ and $c'$.
    We get $c'$ by using the following:
    
    \[ c + (\vec{b} \cdot \vec{a}) \, \vec{a} \]
    
    The fact that $\vec{a}$ is already normalized is to be kept in mind.
    We finally get:
    
    \[ \norm{x - c - (\vec{b} \cdot \vec{a}) \, \vec{a}} - r = 0 \]
    
    \begin{align*}
        0 &= \norm{x - c - (\vec{b} \cdot \vec{a}) \, \vec{a}} - r\\
        &= \left(x - c - (\vec{b} \cdot \vec{a}) \, \vec{a}\right)^2 - r^2\\
    \end{align*}
    
    Now, let us replace $x$ with the explicit ray equation $o + t \, \vec{d}$, where $o$ is its origin point and $\vec{d}$ its vector, and $\vec{b}$ with its definition.
    
    \begin{align*}
        0 &= \left(o + t \, \vec{d} - c - ((o + t \, \vec{d} - c) \cdot \vec{a}) \, \vec{a}\right)^2 - r^2\\
        &= \left(t \, \vec{d} + o - c - ((o + t \, \vec{d} - c) \cdot \vec{a}) \, \vec{a}\right)^2 - r^2\\
        &= \left(t \, \vec{d} + o - c - (t \, \vec{d} \cdot \vec{a}) \, \vec{a} - ((o - c) \cdot \vec{a}) \, \vec{a}\right)^2 - r^2\\
        &= \left(t \, (\vec{d} - (\vec{d} \cdot \vec{a}) \, \vec{a}) + o - c - ((o - c) \cdot \vec{a}) \, \vec{a}\right)^2 - r^2
    \end{align*}
    
    Now, let's define $x = \vec{d} - (\vec{d} \cdot \vec{a}) \, \vec{a}$ and $y = o - c - ((o - c) \cdot \vec{a}) \, \vec{a}$.
    We thus get the following:
    
    \begin{align*}
        0 &= \left(t \, x + y\right)^2 - r^2\\
        &= t^2 \, x^2 + t \, 2xy + y^2 - r^2
    \end{align*}
    
    Let's remember that a vector squared is the result of applying the scalar product on itself.
    We finally get as values for our quadratic function:
    
    \begin{align*}
        A = x^2 &= \left(\vec{d} - (\vec{d} \cdot \vec{a}) \, \vec{a}\right) \cdot \left(\vec{d} - (\vec{d} \cdot \vec{a}) \, \vec{a}\right)\\
        B = 2xy &= 2 \, \left(\vec{d} - (\vec{d} \cdot \vec{a}) \, \vec{a}\right) \cdot \left(o - c - ((o - c) \cdot \vec{a}) \, \vec{a}\right)\\
        C = y^2 - r^2 &= \left(o - c - ((o - c) \cdot \vec{a}) \, \vec{a}\right) \cdot \left(o - c - ((o - c) \cdot \vec{a}) \, \vec{a}\right) - r^2
    \end{align*}
    
\end{document}

